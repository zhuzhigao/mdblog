---
title: 大数据日知录 - 数据分片与路由
date: 2016-12-13 21:00:03
tags:
- Big Data
---
最近看完了大数据日之路。很有意思的书。决定复习一遍，同时把其中重要的东西记录下来，加强下记忆。

## 数据分片与路由
将数据通过某种方式分片，并且mapping到存储的物理机上。若干种常用方法。
<!-- more -->
###  哈希分片
#### Round Robin,就是哈希取模法
H(key) = hash(key)mod(K+1), 缺乏灵活性，特别是K（物理机数目）改变时

#### 虚拟桶(virtual buckets)
加入中间层：虚拟桶，数据线映射到虚拟桶层，虚拟桶再映射到物理机

#### 一致性哈希
哈希表的分布式扩展， 分布式哈希表的一种实现。
K个机器，形成一个2^K的哈希环，每个机器对应环上的某个节点，然后存储前一节点到当前节点的哈希范围内的值。

使用路由表来保存哈希值距离与存储节点的关系。

#### 虚拟节点

一致性哈希的改进。根据机器的新能某机器可以对饮一个或者多个虚拟节点，改进负载均衡，兼顾机器异质性。

### 范围分片
将所有主键惊醒排序。然后在排好序的主键空间将数据分片，每个分片有序记录主键空间内的所有记录。 

分片到物理机的mapping往往采用LSM树。
